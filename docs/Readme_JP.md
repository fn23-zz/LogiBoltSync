# LogiBoltSync

**LogiBoltSync** は、Logitech（ロジクール）製のマウス（例：MX Master 3S）の接続先スロットを、キーボード（例：Signature K855）の接続先切り替えに連動させて自動的に切り替える Python ユーティリティです。

キーボードの「Easy-Switch」ボタンを使って別PCへ切り替えた際、あるいはキーボードの電源を切った際、LogiBoltSyncがその切断を遅延なく検知し、マウスも連動して指定したPCのスロットへ瞬時に切り替えます。これにより、マウスを裏返して手動でボタンを押す手間から解放され、シームレスなマルチPC環境を実現します。

## 主な特徴

- **自動動機**: キーボードの切断を検知し、自動的にマウスに対してHost変更コマンドを発行します。
- **デュアルインターフェース・アーキテクチャ**: メーカー公式ソフトウェア（Logi Options+）によるHIDパケットのブロック・横取りを回避するため、監視用(Monitor)と制御用(Control)で個別のHIDインターフェースを同時に使い分ける独自の実装を行っています。
- **自動構成ツール**: Logi Bolt レシーバー内の各種デバイスID（インデックス番号）はPC環境ごとに異なるため、現在のハードウェア状態を自動解析して設定ファイルを出力するセットアップツールを同梱しています。

## 仕組み

LogiBoltSync は、Logitech HID++ プロトコルを用いて直接 Logi Bolt USB レシーバーと通信します。
数秒間隔でキーボードに対して `GetProtocolVersion` Ping を送信し、タイムアウトや `ERROR_0x10` による通信断（＝別PCへ切り替わった）を検知します。検知した瞬間、マウスへ `ChangeHost` コマンドを送信することで端末の切り替えを行います。

## インストールと使い方

Windows PC への導入や初期設定の手順については、[Install_JP.md](Install_JP.md) の手順書をご参照ください。

## ライセンス

本プロジェクトはオープンソースであり、MIT License の下で公開されています。
